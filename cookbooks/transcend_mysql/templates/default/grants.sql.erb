# Generated by Chef for <%= node['hostname'] %>.
# Local modifications will be overwritten.

<% case node['platform'] -%>
<% when "debian","ubuntu" -%>
GRANT SELECT, EVENT, INSERT, UPDATE, DELETE, TRIGGER, CREATE, CREATE VIEW, SHOW VIEW, ALTER ROUTINE, CREATE ROUTINE, DROP, FILE, REFERENCES, INDEX, ALTER, SHOW DATABASES, CREATE TEMPORARY TABLES, LOCK TABLES, EXECUTE ON *.* TO '<%= node[:mysql][:root_user]%>'@'%' IDENTIFIED BY '<%= node[:mysql][:server_debian_password] %>' WITH GRANT OPTION;
<% end -%>
# Grant replication for a slave user.
GRANT REPLICATION SLAVE ON *.* TO 'repl'@'%' identified by '<%= node['mysql']['server_repl_password'] %>';

# Set the server root password. This should be preseeded by the package installation.
<% if node['mysql']['allow_remote_root'] -%>
GRANT ALL ON *.* TO 'root'@'%' IDENTIFIED BY '<%= node['mysql']['server_root_password'] %>' WITH GRANT OPTION;
<% end -%>
SET PASSWORD FOR 'root'@'localhost' = PASSWORD('<%= node['mysql']['server_root_password'] %>');
